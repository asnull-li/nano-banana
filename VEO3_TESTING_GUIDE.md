# Veo3 è§†é¢‘ç”Ÿæˆ - çœé’±æµ‹è¯•æ–¹æ¡ˆ

## ğŸ¯ æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | æˆæœ¬ | é€Ÿåº¦ | çœŸå®åº¦ | é€‚ç”¨åœºæ™¯ |
|------|------|------|--------|----------|
| **Mock æ¨¡å¼** | ğŸ’° å…è´¹ | âš¡ 3ç§’ | â­ ä½ | å‰ç«¯å¼€å‘ã€UIæµ‹è¯• |
| **æµ‹è¯•ç§¯åˆ†** | ğŸ’°ğŸ’° 1æ¬¡ | â±ï¸ çœŸå® | â­â­â­ é«˜ | æ¥å£éªŒè¯ |
| **ä»… Fast æ¨¡å¼** | ğŸ’°ğŸ’°ğŸ’° 40ç§¯åˆ† | â±ï¸ çœŸå® | â­â­â­ é«˜ | å®Œæ•´åŠŸèƒ½æµ‹è¯• |
| **ç”Ÿäº§ç¯å¢ƒ** | ğŸ’°ğŸ’°ğŸ’°ğŸ’° 300ç§¯åˆ† | â±ï¸ çœŸå® | â­â­â­â­â­ æœ€é«˜ | æ­£å¼å‘å¸ƒ |

---

## ğŸ­ æ–¹æ¡ˆ1: Mock æ¨¡å¼ï¼ˆæ¨èï¼‰

### ä¼˜åŠ¿
- âœ… **å®Œå…¨å…è´¹**
- âœ… **3ç§’å“åº”**ï¼ˆä¸ç”¨ç­‰5-10åˆ†é’Ÿï¼‰
- âœ… **ä¸æ‰£ç§¯åˆ†**
- âœ… **ä½¿ç”¨çœŸå®çš„æµ‹è¯•è§†é¢‘**
- âœ… **æ¨¡æ‹Ÿå®Œæ•´æµç¨‹**ï¼ˆæäº¤ â†’ Webhook â†’ R2è½¬å­˜ï¼‰

### å¯ç”¨æ–¹æ³•

#### 1. æ·»åŠ ç¯å¢ƒå˜é‡
åœ¨ `.env.local` æ·»åŠ ï¼š
```env
NEXT_PUBLIC_VEO3_MOCK=true
```

#### 2. é‡å¯å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```

#### 3. æ­£å¸¸è°ƒç”¨ API
```bash
curl -X POST http://localhost:3000/api/veo3/submit \
  -H "Content-Type: application/json" \
  -d '{
    "type": "text-to-video",
    "prompt": "A cute cat playing with yarn",
    "model": "veo3_fast"
  }'
```

### Mock è¡Œä¸º
1. **ç«‹å³è¿”å›** `mock_veo3_xxx` æ ¼å¼çš„ taskId
2. **3ç§’åè‡ªåŠ¨è§¦å‘ Webhook**ï¼ˆæ¨¡æ‹Ÿ Veo3 å›è°ƒï¼‰
3. ä½¿ç”¨ Google çš„**å…è´¹æµ‹è¯•è§†é¢‘**ï¼š
   - 720p: [Big Buck Bunny](https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4)
   - 1080p: [Elephants Dream](https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4)
4. **æ­£å¸¸æ‰£ç§¯åˆ†** + **æ­£å¸¸é€€æ¬¾**ï¼ˆæµ‹è¯•ç§¯åˆ†ç³»ç»Ÿï¼‰

### å…³é—­ Mock
åˆ é™¤æˆ–è®¾ç½®ä¸º falseï¼š
```env
NEXT_PUBLIC_VEO3_MOCK=false
```

---

## ğŸ’¡ æ–¹æ¡ˆ2: æµ‹è¯•ç”¨æˆ· + ä½ç§¯åˆ†

### ç­–ç•¥
1. åˆ›å»ºä¸“é—¨çš„æµ‹è¯•è´¦æˆ·
2. åªå……å€¼å°‘é‡ç§¯åˆ†ï¼ˆæ¯”å¦‚ 100 ç§¯åˆ† = 2æ¬¡ veo3_fastï¼‰
3. æ¯æ¬¡æµ‹è¯•å‰æ£€æŸ¥ç§¯åˆ†ä½™é¢

### å®æ–½æ­¥éª¤
```sql
-- ç»™æµ‹è¯•ç”¨æˆ·å……å€¼ 100 ç§¯åˆ†
INSERT INTO credits (trans_no, user_uuid, trans_type, credits, created_at)
VALUES ('test_credits_001', 'test_user_uuid', 'system_add', 100, NOW());
```

### æµ‹è¯•ä¼˜å…ˆçº§
1. **ä¼˜å…ˆæµ‹è¯• veo3_fast**ï¼ˆ40ç§¯åˆ†ï¼‰
2. åªåœ¨å¿…è¦æ—¶æµ‹è¯• veo3 Qualityï¼ˆ300ç§¯åˆ†ï¼‰
3. 1080P å‡çº§å•ç‹¬æµ‹è¯•ï¼ˆ8ç§¯åˆ†ï¼‰

---

## ğŸ”§ æ–¹æ¡ˆ3: æ¡ä»¶æ€§çœŸå®è°ƒç”¨

### ç­–ç•¥
åªåœ¨ç‰¹å®šæ¡ä»¶ä¸‹è°ƒç”¨çœŸå® APIï¼š

```typescript
// åœ¨ submit API ä¸­æ·»åŠ æ£€æŸ¥
const isMockMode = process.env.NEXT_PUBLIC_VEO3_MOCK === "true";
const isTestUser = user_uuid.startsWith("test_");

// æµ‹è¯•ç”¨æˆ· + é Mock æ¨¡å¼ = ä½¿ç”¨ veo3_fast
if (isTestUser && !isMockMode) {
  model = "veo3_fast"; // å¼ºåˆ¶ä½¿ç”¨ä¾¿å®œçš„æ¨¡å‹
}
```

---

## ğŸ“Š æ–¹æ¡ˆ4: å¤ç”¨å·²ç”Ÿæˆçš„è§†é¢‘

### ç­–ç•¥
ä¿å­˜ä¸€äº›å·²ç»ç”Ÿæˆçš„è§†é¢‘ï¼Œåœ¨å¼€å‘æ—¶ç›´æ¥ä½¿ç”¨ï¼š

```typescript
// åœ¨æµ‹è¯•ç¯å¢ƒè¿”å›å†å²æˆåŠŸçš„è§†é¢‘
const CACHED_TEST_VIDEOS = [
  { taskId: "real_task_001", url: "https://..." },
  { taskId: "real_task_002", url: "https://..." },
];
```

---

## ğŸ¯ æ¨èæµ‹è¯•æµç¨‹

### é˜¶æ®µ1: å‰ç«¯å¼€å‘ï¼ˆMockæ¨¡å¼ï¼‰
```env
NEXT_PUBLIC_VEO3_MOCK=true
```
- âœ… UI å¸ƒå±€
- âœ… è¡¨å•éªŒè¯
- âœ… çŠ¶æ€ç®¡ç†
- âœ… é”™è¯¯å¤„ç†
- âœ… åŠ è½½åŠ¨ç”»

**æˆæœ¬**: 0 ç§¯åˆ†

---

### é˜¶æ®µ2: æ¥å£éªŒè¯ï¼ˆ1-2æ¬¡çœŸå®è°ƒç”¨ï¼‰
```env
NEXT_PUBLIC_VEO3_MOCK=false
```
- âœ… æµ‹è¯• veo3_fastï¼ˆ40ç§¯åˆ† Ã— 1æ¬¡ = 40ç§¯åˆ†ï¼‰
- âœ… æµ‹è¯• webhook çœŸå®å›è°ƒ
- âœ… æµ‹è¯• R2 è½¬å­˜

**æˆæœ¬**: 40-80 ç§¯åˆ†

---

### é˜¶æ®µ3: å®Œæ•´åŠŸèƒ½æµ‹è¯•
- âœ… æµ‹è¯• 16:9 + 1080P å‡çº§ï¼ˆ40 + 8 = 48ç§¯åˆ†ï¼‰
- âœ… æµ‹è¯•é”™è¯¯åœºæ™¯ï¼ˆç§¯åˆ†é€€æ¬¾ï¼‰
- âœ… æµ‹è¯•å†å²è®°å½•

**æˆæœ¬**: 50-100 ç§¯åˆ†

---

### é˜¶æ®µ4: ç”Ÿäº§éªŒè¯ï¼ˆå¯é€‰ï¼‰
- âœ… veo3 Quality æµ‹è¯• 1æ¬¡ï¼ˆ300ç§¯åˆ†ï¼‰

**æˆæœ¬**: 300 ç§¯åˆ†

---

## ğŸ’° æˆæœ¬ä¼°ç®—

| æµ‹è¯•æ–¹æ¡ˆ | æ€»æˆæœ¬ | è¯´æ˜ |
|----------|--------|------|
| **çº¯ Mock å¼€å‘** | 0ç§¯åˆ† | 90% çš„å¼€å‘å·¥ä½œ |
| **åŸºç¡€éªŒè¯** | 40-80ç§¯åˆ† | æ¥å£å¯¹æ¥éªŒè¯ |
| **å®Œæ•´æµ‹è¯•** | 150-200ç§¯åˆ† | åŒ…å«1080På’Œé”™è¯¯åœºæ™¯ |
| **ç”Ÿäº§éªŒè¯** | 500ç§¯åˆ† | å®Œæ•´æµç¨‹ + Qualityæ¨¡å¼ |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯ç”¨ Mock æ¨¡å¼
```bash
echo "NEXT_PUBLIC_VEO3_MOCK=true" >> .env.local
npm run dev
```

### 2. æµ‹è¯•æäº¤
è®¿é—®å‰ç«¯é¡µé¢æˆ–è°ƒç”¨ APIï¼š
```bash
curl -X POST http://localhost:3000/api/veo3/submit \
  -H "Content-Type: application/json" \
  -H "Cookie: your-auth-cookie" \
  -d '{
    "type": "text-to-video",
    "prompt": "æµ‹è¯•è§†é¢‘",
    "model": "veo3_fast",
    "aspect_ratio": "16:9"
  }'
```

### 3. æŸ¥çœ‹æ§åˆ¶å°
åº”è¯¥çœ‹åˆ°ï¼š
```
ğŸ­ [MOCK MODE] Veo3 generateVideo: mock_veo3_1234567890_abc123
ğŸ­ [MOCK MODE] Webhook sent for: mock_veo3_1234567890_abc123
```

### 4. æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
```bash
curl http://localhost:3000/api/veo3/status/{task_id}
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **Mock è§†é¢‘ä¸ä¼šçœŸçš„è½¬å­˜ R2**ï¼ˆé¿å…äº§ç”Ÿå­˜å‚¨è´¹ç”¨ï¼‰
2. **ç§¯åˆ†ä»ç„¶ä¼šæ‰£é™¤**ï¼ˆæµ‹è¯•ç§¯åˆ†ç³»ç»Ÿï¼‰
3. **å…³é—­ Mock å‰åŠ¡å¿…ç¡®è®¤**ï¼ˆé¿å…æ„å¤–æ‰£è´¹ï¼‰
4. **ç”Ÿäº§ç¯å¢ƒåŠ¡å¿…å…³é—­ Mock**

---

## ğŸ” è°ƒè¯•æŠ€å·§

### æ£€æŸ¥ Mock çŠ¶æ€
```typescript
console.log("Mock enabled:", process.env.NEXT_PUBLIC_VEO3_MOCK);
```

### æ¨¡æ‹Ÿå¤±è´¥åœºæ™¯
ä¿®æ”¹ `veo3-client.ts`ï¼š
```typescript
if (ENABLE_MOCK) {
  // æ¨¡æ‹Ÿå¤±è´¥
  setTimeout(() => {
    fetch(params.callBackUrl!, {
      method: "POST",
      body: JSON.stringify({
        code: 500,
        data: { taskId: mockTaskId, errorCode: "MOCK_ERROR" },
        msg: "Mock failure"
      })
    });
  }, 3000);
}
```

---

**æ¨èï¼šå¼€å‘é˜¶æ®µå…¨ç¨‹ä½¿ç”¨ Mock æ¨¡å¼ï¼Œåªåœ¨éƒ¨ç½²å‰æµ‹è¯• 1-2 æ¬¡çœŸå®è°ƒç”¨ï¼** ğŸ‰
